'''
The mortality data we have is currently in in seperate files. These files have yearly data from 2003-2015. We need to append these together into one master file to use.  
The data we have on causes of death does not contain any FIPs codes. These codes are vital to us merging the datasets together.
Having data on deaths will allow us to better undesrtand the effect of the interventions on the drug crisis.

Files are named  with the following convention: [Underlying Cause of Death, 2003.txt]. We can substitute each year in the file name to import different files

'''

import pandas as pd 

### Reading in files and appending to make one large file. We are iterating from 0 to 12 and adding 3 each time. 
### This should produce numbers from 3-15, which correspond to the last two digits in each file.
### We can use the digits generated to create a string name for each file.
### We read in the tab-delimited files and then append the dataframes together to make one large dataframe. 

drug_data_full = pd.Dataframe()
for i in range(13):
    name = 'Underlying Cause of Death, 20' + str(i+3)+'.txt'
    temp_data = pd.read_csv(name, delimiter="\t")
    drug_data_full = drug_data_full.append(temp_data)
    
##Check results

drug_data_full.head()

###Here we have code that appends the fips codes to the dataset. 